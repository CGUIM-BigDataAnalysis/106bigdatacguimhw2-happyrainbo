Analysis%>%
ggplot()+
geom_point(aes(x=來台讀書國別,y=來台讀書人數),color="red")+
geom_point(aes(x=離台讀書國別,y=離台讀書人數),color="blue")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
#第九題
Analysis<-rbind(top_n(ToTWNCountry,20),top_n(FromTWNCountry,20))
#第九題
ToTW<-ToTWNCountry
FromTW<-FromTWNCountry
View(FromTW)
View(ToTW)
ColName<-c("國別","人數")
colnames(ToTW)<-ColName
colnames(FromTW)<-ColName
Analysis<-rbind(top_n(ToTWNCountry,20),top_n(FromTWNCountry,20))
Analysis<-rbind(top_n(ToTW,20),top_n(FromTW,20))
Analysis$類別[1:20]<-"來台"
Analysis$類別[21:40]<-"離台"
Analysis%>%
ggplot()+
geom_bar(aes(x=國別,y=人數,color=類別),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,color=類別))+
geom_bar(stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別))+
geom_bar(stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
ggplot(aes(x=reorder(國別,-人數),y=人數))+
geom_bar(stat="identity",position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="國別")
ggplot(aes(x=reorder(國別,-人數),y=人數))+
geom_bar(stat="identity",position=fill)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="國別")
ggplot(aes(x=reorder(國別,-人數),y=人數))+
geom_bar(stat="identity",position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="國別")
ggplot(aes(x=reorder(國別,-人數),y=人數))+
geom_bar(stat="identity",position="stack")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="國別")
str(Analysis)
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別))+
geom_bar(stat="identity",position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別))+
geom_bar(stat="identity",position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別),size=0.25)+
geom_bar(stat="identity",position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",width=0.5)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",width=0.75)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
#第九題
ToTW<-ToTWNCountry
FromTW<-FromTWNCountry
ColName<-c("國別","人數")
colnames(ToTW)<-ColName
colnames(FromTW)<-ColName
mydata<-rbind(top_n(ToTW,20),top_n(FromTW,20))
mydata$類別[1:20]<-"來台"
mydata$類別[21:40]<-"離台"
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別,order=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,color=類別,fill=類別,order=人數))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別,order=國別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(arrange(類別),aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis<-mydata%>%
ggplot(arrange("類別"),aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis<-mydata%>%
ggplot(arrange("人數"),aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_col(position=position_stack(reverse=T))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=reorder(類別,-人數)))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=reorder(類別)))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=reorder(類別,人數)))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-類別),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(arrange(mydata,類別),aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
str(mydata)
Analysis<-mydata%>%
ggplot(arrange(mydata,人數),aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis<-mydata%>%
ggplot(aes(x=國別,y=類別,fill=人數))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
mydata<-mydata%>%
arrange(desc(人數))
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="dodge")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="count",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
mydata$類別[1:20]<-1
mydata$類別[21:40]<-2
mydata<-rbind(top_n(ToTW,20),top_n(FromTW,20))
mydata$類別[1:20]<-1
mydata$類別[21:40]<-2
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
mydata<-rbind(top_n(ToTW,20),top_n(FromTW,20))
mydata$類別[1:20]<-"來台"
mydata$類別[21:40]<-"離台"
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,fill=類別))+
geom_bar(width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
Analysis<-mydata%>%
ggplot(aes(x=reorder(國別,-人數),y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(y="比例")
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.7,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(y="比例")
Analysis
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.5,position="fill")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(y="比例")
Analysis
#第九題
ToTW<-ToTWNCountry
FromTW<-FromTWNCountry
ColName<-c("國別","人數")
colnames(ToTW)<-ColName
colnames(FromTW)<-ColName
Analysis<-mydata%>%
ggplot(aes(x=國別,y=人數,fill=類別))+
geom_bar(stat="identity",width=0.5)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))
Analysis
ToTW$國別[32]<-"白俄羅斯共和國"
#第九題
ToTW<-ToTWNCountry
FromTW<-FromTWNCountry
ColName<-c("國別","人數")
colnames(ToTW)<-ColName
colnames(FromTW)<-ColName
ToTW$國別[32]
ToTW$國別[32]
library(readr)
library(dplyr)
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
library(RColorBrewer)
library(jsonlite)
library(plotly)
ToTW$國別[32]
ToTW$國別
ToTW$國別
ToTW$國別
ToTW$國別[88]<-"白俄羅斯共和國"
ToTW$國別[155]<-"馬爾他共和國"
ToTW$國別[117]<-"模里西斯共和國"
Analysis.2<-inner_join(ToTW,FromTW,by=國別)
Analysis.2<-inner_join(ToTW,FromTW,by=國別)
Analysis.2<-inner_join(ToTW,FromTW,by="國別")
library(readr)
library(dplyr)
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
library(RColorBrewer)
library(jsonlite)
library(plotly)
ToTW$國別[88]<-"白俄羅斯共和國"
ToTW$國別[155]<-"馬爾他共和國"
ToTW$國別[117]<-"模里西斯共和國"
Analysis.2<-inner_join(ToTW,FromTW,by="國別")
View(Analysis.2)
mydata<-inner_join(ToTW,FromTW,by="國別")
Analysis.2<-mydata%>%
filter(離台來台比=人數.y/人數.x)
Analysis.2<-mydata%>%
summarise(離台來台比=人數.y/人數.x)
Analysis.2<-mydata%>%
summarise(離台來台比=人數.y/人數.x)
Analysis.2<-mydata%>%
summarise(離台來台比=人數.y/人數.x)
library(readr)
library(dplyr)
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
library(RColorBrewer)
library(jsonlite)
library(plotly)
Analysis.2<-mydata%>%
summarise(離台來台比=人數.y/人數.x)
Analysis.2<-mydata%>%
mutate(離台來台比=人數.y/人數.x)
Analysis.2<-mydata%>%
mutate(離台來台比=人數.y/人數.x)
library(readr)
library(dplyr)
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
library(RColorBrewer)
library(jsonlite)
library(plotly)
Analysis.2<-mydata%>%
mutate(離台來台比=人數.y/人數.x)
Analysis.2<-mydata%>%
mutate(離台來台比=人數.y/人數.x)%>%
arrange(desc(離台來台比))%>%
select(國別,離台來台比)
View(FromTW)
head(Analysis.2)
head(Analysis.2)
Analysis
a<-full_join(ToTW,FromTW,by="國別")
View(a)
nrow(a)
nrow(a)
Analysis.2<-full_join(ToTW,FromTW,by="國別")
View(Analysis.2)
nrow(Analysis.2)
View(mydata)
rm(a)
rm(Analysis.2)
colnames(mydata)<-c("國別","來台人數","離台人數")
colnames(mydata)<-c("國別","來台人數","離台人數")
Analysis.FromTo<-mydata%>%
mutate(離台來台人數比=離台人數/來台人數)%>%
arrange(desc(離台來台比))%>%
select(國別,離台來台比)
Analysis.FromTo<-mydata%>%
mutate(離台來台人數比=離台人數/來台人數)%>%
arrange(desc(離台來台人數比))%>%
select(國別,離台來台人數比)
View(Analysis.FromTo)
install.packages("mlbench")
library(mlbench)
data("BostonHousing")
glm(medv~crim+tax+dis,data=BostonHousing)
data("PimaIndiansDiabetes")
glm(diabets~pregant+glucose+triceps+mass,data=PimaIndiansDiabetes)
glm(diabetes~pregant+glucose+triceps+mass,data=PimaIndiansDiabetes)
glm(diabetes~pregnant+glucose+triceps+mass,data=PimaIndiansDiabetes)
glm(diabetes~pregnant+glucose+triceps+mass,data=PimaIndiansDiabetes,family="binomial")
install.packages("rpart")
install.packages("rpart.plot")
library(rpart)
library(rpart.plot)
DT<-rpart(diabetes~.,data=PimaIndiansDiabetes)
prp(DT)
