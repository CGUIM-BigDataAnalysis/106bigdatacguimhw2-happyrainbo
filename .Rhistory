View(df_2)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-leftjoin(worldMap.df,mydata,by="id")
worldMap.df<-left_join(worldMap.df,mydata,by="id")
str(worldMap.df)
worldMap.df$id<-as.numeric(worldMap.df$id)
worldMap.df<-left_join(worldMap.df,mydata,by="id")
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df_2<-worldMap.df%>%
select(long:ISO3,Taiwan)
View(worldmap.df_2)
View(countryName)
countryName$Taiwan[48]<-"中國大陸"
countryName$Taiwan[122]<-"南韓"
countryName$Taiwan[166]<-"納戈爾諾-卡拉巴赫"
countryName$Taiwan[199]<-"新加坡"
countryName$Taiwan[228]<-"吐瓦魯"
countryName$Taiwan[229]<-"臺灣"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df_2<-worldMap.df%>%
select(long:ISO3,Taiwan)
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
#shapefile轉為data.frame
worldMap.df<-fortify(worldMap)
worldMap.df$id<-as.numeric(worldMap.df$id)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-left_join(worldMap.df,mydata,by="id")
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df_2<-worldMap.df%>%
select(long:ISO3,Taiwan)
View(ToTWNCountry)
final.data<-full_join(worldmap.df_2,ToTWNCountry,by=c("Taiwan","國別"))
final.data<-right_join(worldmap.df_2,ToTWNCountry,by=c("Taiwan","國別"))
final.data<-left_join(worldmap.df_2,ToTWNCountry,by=c("Taiwan","國別"))
str(worldmap.df_2)
str(ToTWNCountry)
final.data<-merge(worldmap.df_2,ToTWNCountry,by=c("Taiwan","國別"))
final.data<-inner_join(worldmap.df_2,ToTWNCountry,by=c("Taiwan","國別"))
colnames(worldmap.df_2)[10]<-"國別"
final.data<-inner_join(worldmap.df_2,ToTWNCountry,by="國別")
View(final.data)
ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
final.data<-left_join(worldmap.df_2,ToTWNCountry,by="國別")
ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
final.data<-inner_join(worldmap.df_2,ToTWNCountry,by="國別")
ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
final.data<-left_join(worldmap.df_2,ToTWNCountry,by="國別")
ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
ggplotlt(plot3)
ggplotly(plot3)
final.data<-left_join(worldmap.df_2,ToTWNCountry,by="國別")
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
ggplotly(plot3)
plot3
ggplotly(plot3)
plot3
ggplotly(plot3)
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
plot3
ggplotly(plot3)
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(19,"Blues"))+
theme_void()
plot3
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
plot3
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(9,"Blues"))+
theme_void()
plot3
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
plot3
ggplotly(plot3)
#第三題
#讀取shapefile
worldMap<-readShapeSpatial("ne_110m_admin_0_countries/ne_110m_admin_0_countries.shp")
#shapefile轉為data.frame
worldMap.df<-fortify(worldMap)
worldMap.df$id<-as.numeric(worldMap.df$id)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-left_join(worldMap.df,mydata,by="id")
countryName<-fromJSON("countries.json")
countryName$Taiwan[48]<-"中國大陸"
countryName$Taiwan[122]<-"南韓"
countryName$Taiwan[166]<-"納戈爾諾-卡拉巴赫"
countryName$Taiwan[199]<-"新加坡"
countryName$Taiwan[228]<-"吐瓦魯"
countryName$Taiwan[229]<-"臺灣"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldmap.df_2)[10]<-"國別"
final.data<-left_join(worldmap.df,ToTWNCountry,by="國別")
#第三題
#讀取shapefile
worldMap<-readShapeSpatial("ne_110m_admin_0_countries/ne_110m_admin_0_countries.shp")
#shapefile轉為data.frame
worldMap.df<-fortify(worldMap)
worldMap.df$id<-as.numeric(worldMap.df$id)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-left_join(worldMap.df,mydata,by="id")
countryName<-fromJSON("countries.json")
countryName$Taiwan[48]<-"中國大陸"
countryName$Taiwan[122]<-"南韓"
countryName$Taiwan[166]<-"納戈爾諾-卡拉巴赫"
countryName$Taiwan[199]<-"新加坡"
countryName$Taiwan[228]<-"吐瓦魯"
countryName$Taiwan[229]<-"臺灣"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldmap.df)[10]<-"國別"
final.data<-left_join(worldmap.df,ToTWNCountry,by="國別")
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
plot3
View(overseasStudentCountry)
View(countryName)
View(ToTWNCountry)
ToTWNCountry$國別
View(mydata)
View(country)
View(countryName)
countryName$Taiwan[2]<-"阿拉伯聯合大公國"
countryName$Taiwan[17]<-"波士尼亞與赫塞哥維納"
countryName$Taiwan[40]<-"剛果民主共和國"
countryName$Taiwan[48]<-"中國大陸"
countryName$Taiwan[73]<-"密克羅尼西亞"
countryName$Taiwan[98]<-"克羅埃西亞"
countryName$Taiwan[119]<-"葛摩聯盟"
countryName$Taiwan[120]<-"聖克里斯多福"
countryName$Taiwan[122]<-"南韓"
countryName$Taiwan[160]<-"納米比亞"
countryName$Taiwan[143]<-"馬紹爾群島共和國"
countryName$Taiwan[153]<-"馬爾他"
countryName$Taiwan[166]<-"納戈爾諾-卡拉巴赫"
countryName$Taiwan[177]<-"巴布亞紐幾內亞"
countryName$Taiwan[191]<-"塞爾維亞共和國"
countryName$Taiwan[195]<-"索羅門群島"
countryName$Taiwan[199]<-"新加坡"
countryName$Taiwan[204]<-"獅子山共和國"
countryName$Taiwan[207]<-"索馬利亞民主共和國"
countryName$Taiwan[209]<-"南蘇丹共和國"
countryName$Taiwan[227]<-"千里達"
countryName$Taiwan[228]<-"吐瓦魯"
countryName$Taiwan[229]<-"臺灣"
countryName$Taiwan[238]<-"聖文森"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldmap.df)[10]<-"國別"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldmap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldmap.df)[10]<-"國別"
final.data<-left_join(worldmap.df,ToTWNCountry,by="國別")
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
ggplotly(plot3)
View(worldMap.df)
View(worldMap.df)
View(mydata)
View(localStudent)
#shapefile轉為data.frame
worldMap.df<-fortify(worldMap)
worldMap.df$id<-as.numeric(worldMap.df$id)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-left_join(worldMap.df,mydata,by="id")
countryName<-fromJSON("countries.json")
countryName$Taiwan[2]<-"阿拉伯聯合大公國"
countryName$Taiwan[17]<-"波士尼亞與赫塞哥維納"
countryName$Taiwan[40]<-"剛果民主共和國"
countryName$Taiwan[48]<-"中國大陸"
countryName$Taiwan[73]<-"密克羅尼西亞"
countryName$Taiwan[98]<-"克羅埃西亞"
countryName$Taiwan[119]<-"葛摩聯盟"
countryName$Taiwan[120]<-"聖克里斯多福"
countryName$Taiwan[122]<-"南韓"
countryName$Taiwan[160]<-"納米比亞"
countryName$Taiwan[143]<-"馬紹爾群島共和國"
countryName$Taiwan[153]<-"馬爾他"
countryName$Taiwan[166]<-"納戈爾諾-卡拉巴赫"
countryName$Taiwan[177]<-"巴布亞紐幾內亞"
countryName$Taiwan[191]<-"塞爾維亞共和國"
countryName$Taiwan[195]<-"索羅門群島"
countryName$Taiwan[199]<-"新加坡"
countryName$Taiwan[204]<-"獅子山共和國"
countryName$Taiwan[207]<-"索馬利亞民主共和國"
countryName$Taiwan[209]<-"南蘇丹共和國"
countryName$Taiwan[227]<-"千里達"
countryName$Taiwan[228]<-"吐瓦魯"
countryName$Taiwan[229]<-"臺灣"
countryName$Taiwan[238]<-"聖文森"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldMap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldMap.df)[10]<-"國別"
final.data<-left_join(worldMap.df,ToTWNCountry,by="國別")
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
plot3
View(df)
rm(df)
rm(df_2)
rm(worldmap.df)
rm(worldmap.df_2)
第三題
#讀取shapefile
worldMap<-readShapeSpatial("ne_110m_admin_0_countries/ne_110m_admin_0_countries.shp")
#shapefile轉為data.frame
worldMap.df<-fortify(worldMap)
worldMap.df$id<-as.numeric(worldMap.df$id)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-left_join(worldMap.df,mydata,by="id")
countryName<-fromJSON("countries.json")
countryName$Taiwan[2]<-"阿拉伯聯合大公國"
countryName$Taiwan[13]<-"澳大利亞"
countryName$Taiwan[17]<-"波士尼亞與赫塞哥維納"
countryName$Taiwan[40]<-"剛果民主共和國"
countryName$Taiwan[48]<-"中國大陸"
countryName$Taiwan[55]<-"賽普勒斯"
countryName$Taiwan[73]<-"密克羅尼西亞"
countryName$Taiwan[98]<-"克羅埃西亞"
countryName$Taiwan[119]<-"葛摩聯盟"
countryName$Taiwan[120]<-"聖克里斯多福"
countryName$Taiwan[122]<-"南韓"
countryName$Taiwan[160]<-"納米比亞"
countryName$Taiwan[143]<-"馬紹爾群島共和國"
countryName$Taiwan[153]<-"馬爾他"
countryName$Taiwan[166]<-"納戈爾諾-卡拉巴赫"
countryName$Taiwan[177]<-"巴布亞紐幾內亞"
countryName$Taiwan[191]<-"塞爾維亞共和國"
countryName$Taiwan[195]<-"索羅門群島"
countryName$Taiwan[199]<-"新加坡"
countryName$Taiwan[204]<-"獅子山共和國"
countryName$Taiwan[207]<-"索馬利亞民主共和國"
countryName$Taiwan[209]<-"南蘇丹共和國"
countryName$Taiwan[227]<-"千里達"
countryName$Taiwan[228]<-"吐瓦魯"
countryName$Taiwan[229]<-"臺灣"
countryName$Taiwan[238]<-"聖文森"
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldMap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldMap.df)[10]<-"國別"
final.data<-left_join(worldMap.df,ToTWNCountry,by="國別")
plot3<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
plot3
ggplotly(plot3)
index<-c(2,13,17,40,48,55,73,98,119,120,122,143,153,160,166,177,191,195,199,204,207,209,227,228,229,238)
Name<-c("阿拉伯聯合大公國","澳大利亞","波士尼亞與赫塞哥維納","剛果民主共和國","中國大陸","賽普勒斯","密克羅尼西亞",
"克羅埃西亞","葛摩聯盟","聖克里斯多福","南韓","馬紹爾群島共和國","馬爾他","納米比亞","納戈爾諾-卡拉巴赫",
"巴布亞紐幾內亞","塞爾維亞共和國","索羅門群島","新加坡","獅子山共和國","索馬利亞民主共和國","南蘇丹共和國",
"千里達","吐瓦魯","臺灣","聖文森")
length(index)
length(Name)
countryName$Taiwan[index]<-Name
ToTWNCountryMap<-ggplot()+
geom_polygon(data=final.data,aes(x=long,y=lat,group=group,fill=總人數),color="black",size=0.25)+
coord_quickmap()+
scale_fill_gradientn(colours=brewer.pal(7,"Blues"))+
theme_void()
ToTWNCountryMap
View(countryName)
View(country)
View(mydata)
#shapefile轉為data.frame
worldMap.df<-fortify(worldMap)
str(worldMap.df)
View(worldMap.df)
worldMap.df$id<-as.numeric(worldMap.df$id)
#建立表格
mydata<-data.frame(Name=worldMap$NAME_LONG,ISO3=worldMap$ISO_A3,id=seq(0,length(worldMap$ISO_A3)-1))
#因子轉字串和補遺漏值
mydata$ISO3<-as.character(mydata$ISO3)
mydata$ISO3[56]<-"FRA"
mydata$ISO3[119]<-"NOR"
worldMap.df<-left_join(worldMap.df,mydata,by="id")
#讀取國家中英對照表
countryName<-fromJSON("countries.json")
#國家中英對照表處理
index<-c(2,13,17,40,48,55,73,98,119,120,122,143,153,160,166,177,191,195,199,204,207,209,227,228,229,238)
Name<-c("阿拉伯聯合大公國","澳大利亞","波士尼亞與赫塞哥維納","剛果民主共和國","中國大陸","賽普勒斯","密克羅尼西亞",
"克羅埃西亞","葛摩聯盟","聖克里斯多福","南韓","馬紹爾群島共和國","馬爾他","納米比亞","納戈爾諾-卡拉巴赫",
"巴布亞紐幾內亞","塞爾維亞共和國","索羅門群島","新加坡","獅子山共和國","索馬利亞民主共和國","南蘇丹共和國",
"千里達","吐瓦魯","臺灣","聖文森")
countryName$Taiwan[index]<-Name
#表格合併
worldMap.df<-left_join(worldMap.df,countryName,by="ISO3")
worldMap.df<-worldMap.df%>%
select(long:ISO3,Taiwan)
colnames(worldMap.df)[10]<-"國別"
final.data<-left_join(worldMap.df,ToTWNCountry,by="國別")
View(final.data)
#第四題
#讀取資料
#大專校院本國學生出國進修交流數
localStudent<-read_csv("Student_RPT.csv",skip=2)
#欄位名稱處理
ColName<-c("學年度","學期","學校設立別","學校類別","學校代碼","學校名稱","系所代碼","系所名稱","學制","對方學校國別",
"對方學校中文名稱","對方學校英文名稱","本國學生出國進修、交流人數小計","本國學生出國進修、交流人數_男",
"本國學生出國進修、交流人數_女")
length(ColName)
colnames(localStudent)<-ColName
View(localStudent)
length(complete.cases(localStudent))
complete.cases(localStudent)
tail(complete.cases(localStudent))
localStudent<-localStudent[complete.cases(localStudent)]
localStudent<-localStudent[complete.cases(localStudent),]
#第四題
#讀取資料
#大專校院本國學生出國進修交流數
localStudent<-read_csv("Student_RPT.csv",skip=2)
#欄位名稱處理
ColName<-c("學年度","學期","學校設立別","學校類別","學校代碼","學校名稱","系所代碼","系所名稱","學制","對方學校國別",
"對方學校中文名稱","對方學校英文名稱","本國學生出國進修、交流人數小計","本國學生出國進修、交流人數_男",
"本國學生出國進修、交流人數_女")
colnames(localStudent)<-ColName
localStudent<-localStudent[1:35020,]
localStudent%>%
group_by(對方學校國別)%>%
summarise(人數=sum(`本國學生出國進修、交流人數小計`))
FromTWNCountry<-localStudent%>%
group_by(對方學校國別)%>%
summarise(人數=sum(`本國學生出國進修、交流人數小計`))%>%
arrange(desc(人數))
rm(plot3)
View(FromTWNCountry)
head(FromTWNCountry,10)
localStudent$學年度
str(localStudent)
FromTWNCountry<-localStudent%>%
filter(學年度>=103)
View(FromTWNCountry)
FromTWNCountry<-localStudent%>%
filter(學年度>=103)%>%
group_by(對方學校國別)%>%
summarise(人數=sum(`本國學生出國進修、交流人數小計`))%>%
arrange(desc(人數))
#第四題_後
FromTWNUniversity<-localStudent%>%
filter(學年度>=103)%>%
group_by(學校名稱)%>%
summarise(人數=sum(`本國學生出國進修、交流人數小計`))%>%
arrange(desc(人數))
head(FromTWNUniversity)
View(FromTWNUniversity)
View(FromTWNUniversity)
#第五題
FromTWNUniversity_20Row<-rbind(top_n(FromTWNUniversity,19),
slice(FromTWNUniversity,20:n())%>%
summarose(學校名稱="其他",人數=sum(人數)))
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x-reorder(學姓名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
#第五題
FromTWNUniversity_20Row<-rbind(top_n(FromTWNUniversity,19),
slice(FromTWNUniversity,20:n())%>%
summarose(學校名稱="其他",人數=sum(人數)))
#第五題
FromTWNUniversity_20Row<-rbind(top_n(FromTWNUniversity,19),
slice(FromTWNUniversity,20:n())%>%
summarise(學校名稱="其他",人數=sum(人數)))
View(FromTWNUniversity_20Row)
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x-reorder(學姓名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar
FromTWNCountryBar
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x-reorder(學姓名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x=reorder(學姓名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x=reorder(學姓名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x=reorder(學校名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar
#第五題
FromTWNUniversity_40Row<-rbind(top_n(FromTWNUniversity,39),
slice(FromTWNUniversity,40:n())%>%
summarise(學校名稱="其他",人數=sum(人數)))
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x=reorder(學校名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar
#第五題
FromTWNUniversity_20Row<-rbind(top_n(FromTWNUniversity,19),
slice(FromTWNUniversity,20:n())%>%
summarise(學校名稱="其他",人數=sum(人數)))
FromTWNCountryBar<-FromTWNUniversity_20Row%>%
ggplot(aes(x=reorder(學校名稱,-人數),y=人數))+
geom_bar(stat="identity")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust=0.4))+
labs(x="學校名稱")
FromTWNCountryBar
View(countryName)
rm(FromTWNUniversity_40Row)
View(FromTWNCountry)
